#include <IRsend.h>

IRsend::IRsend(int pin)
{
    pinMode(pin, OUTPUT);
    IRledPin = pin;
}

void IRsend::liga()
{
delayMicroseconds(30456);
pulseIR(4580);
delayMicroseconds(4740);
pulseIR(480);
delayMicroseconds(1840);
pulseIR(300);
delayMicroseconds(1960);
pulseIR(160);
delayMicroseconds(2160);
pulseIR(500);
delayMicroseconds(680);
pulseIR(500);
delayMicroseconds(680);
pulseIR(440);
delayMicroseconds(680);
pulseIR(480);
delayMicroseconds(660);
pulseIR(500);
delayMicroseconds(660);
pulseIR(480);
delayMicroseconds(140);
pulseIR(120);
delayMicroseconds(140);
pulseIR(80);
delayMicroseconds(1320);
pulseIR(480);
delayMicroseconds(1880);
pulseIR(480);
delayMicroseconds(1800);
pulseIR(460);
delayMicroseconds(700);
pulseIR(480);
delayMicroseconds(720);
pulseIR(340);
delayMicroseconds(820);
pulseIR(420);
delayMicroseconds(680);
pulseIR(480);
delayMicroseconds(620);
pulseIR(500);
delayMicroseconds(1820);
pulseIR(540);
delayMicroseconds(1800);
pulseIR(520);
delayMicroseconds(1800);
pulseIR(500);
delayMicroseconds(1860);
pulseIR(420);
delayMicroseconds(640);
pulseIR(520);
delayMicroseconds(700);
pulseIR(480);
delayMicroseconds(640);
pulseIR(480);
delayMicroseconds(660);
pulseIR(500);
delayMicroseconds(660);
pulseIR(520);
delayMicroseconds(580);
pulseIR(540);
delayMicroseconds(660);
pulseIR(500);
delayMicroseconds(640);
pulseIR(520);
delayMicroseconds(1840);
pulseIR(480);
delayMicroseconds(1800);
pulseIR(520);
delayMicroseconds(1760);
pulseIR(540);
delayMicroseconds(1760);
pulseIR(560);
delayMicroseconds(48320);
pulseIR(4600);
delayMicroseconds(4780);
pulseIR(480);
delayMicroseconds(1720);
pulseIR(560);
delayMicroseconds(120);
pulseIR(80);
delayMicroseconds(1620);
pulseIR(460);
delayMicroseconds(120);
pulseIR(80);
delayMicroseconds(1600);
pulseIR(540);
delayMicroseconds(620);
pulseIR(500);
delayMicroseconds(640);
pulseIR(540);
delayMicroseconds(660);
pulseIR(500);
delayMicroseconds(620);
pulseIR(560);
delayMicroseconds(600);
pulseIR(480);
delayMicroseconds(1840);
pulseIR(500);
delayMicroseconds(1780);
pulseIR(500);
delayMicroseconds(1800);
pulseIR(520);
delayMicroseconds(660);
pulseIR(480);
delayMicroseconds(680);
pulseIR(500);
delayMicroseconds(660);
pulseIR(480);
delayMicroseconds(620);
pulseIR(560);
delayMicroseconds(120);
pulseIR(80);
delayMicroseconds(420);
pulseIR(500);
delayMicroseconds(1780);
pulseIR(580);
delayMicroseconds(1760);
pulseIR(480);
delayMicroseconds(1800);
pulseIR(520);
delayMicroseconds(1900);
pulseIR(400);
delayMicroseconds(680);
pulseIR(480);
delayMicroseconds(820);
pulseIR(340);
delayMicroseconds(720);
pulseIR(420);
delayMicroseconds(680);
pulseIR(480);
delayMicroseconds(720);
pulseIR(460);
delayMicroseconds(660);
pulseIR(460);
delayMicroseconds(660);
pulseIR(500);
delayMicroseconds(660);
pulseIR(520);
delayMicroseconds(1880);
pulseIR(400);
delayMicroseconds(140);
pulseIR(60);
delayMicroseconds(1700);
pulseIR(400);
delayMicroseconds(1780);
pulseIR(560);
delayMicroseconds(1800);
pulseIR(480);
}

void IRsend::desliga()
{
delayMicroseconds(58280);
pulseIR(4680);
delayMicroseconds(4640);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(580);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(560);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(48260);
pulseIR(4680);
delayMicroseconds(4640);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1700);
pulseIR(620);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(600);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(600);
}

void IRsend::aumenta()
{
delayMicroseconds(7584);
pulseIR(4700);
delayMicroseconds(4620);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(620);
delayMicroseconds(1680);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(580);
pulseIR(560);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(600);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(620);
delayMicroseconds(1680);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(1700);
pulseIR(640);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(620);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(560);
pulseIR(620);
delayMicroseconds(540);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(560);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1700);
pulseIR(600);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(48280);
pulseIR(4720);
delayMicroseconds(4600);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(560);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(560);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(560);
pulseIR(620);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(620);
delayMicroseconds(540);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(620);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(560);
pulseIR(580);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(580);
delayMicroseconds(1740);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(620);
delayMicroseconds(1680);
pulseIR(620);
}

void IRsend::diminui()
{
delayMicroseconds(4900);
pulseIR(4700);
delayMicroseconds(4620);
pulseIR(600);
delayMicroseconds(1680);
pulseIR(600);
delayMicroseconds(1740);
pulseIR(580);
delayMicroseconds(1700);
pulseIR(620);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(540);
pulseIR(620);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(1720);
pulseIR(620);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(1720);
pulseIR(560);
delayMicroseconds(580);
pulseIR(580);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(580);
delayMicroseconds(560);
pulseIR(600);
delayMicroseconds(580);
pulseIR(600);
delayMicroseconds(540);
pulseIR(640);
delayMicroseconds(1680);
pulseIR(560);
delayMicroseconds(580);
pulseIR(620);
delayMicroseconds(1700);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(620);
delayMicroseconds(1680);
pulseIR(600);
delayMicroseconds(1700);
pulseIR(640);
}

// a função abaixo é chamada durante a execução dos comandos gerados na captura dos sinais infravermelho emitidos por cada tecla do controle remoto
// o LED acende e apaga repetidamente em um intervalo de tempo medido em microsegundos (1 seg = 1.000.000 microseg) e o ar condicionado detecta e interpreta as piscadas do led 
// infravermelho acionando os comandos respectivos
void pulseIR(long microsecs) {
  cli();  // Desativa quaisquer interrupções de fundo
  while (microsecs > 0) {
    // 38 kHz tem cerca de 13 microssegundos em nível lógico alto e 13 microssegundos em baixo
    digitalWrite(IRledPin, HIGH);  // liga o LED. A execução desta linha leva cerca de 3 microsegundos
    delayMicroseconds(10);         // aguarda por 10 microseconds
    digitalWrite(IRledPin, LOW);   // desliga o LED. A execução desta linha leva cerca de 3 microsegundos
    delayMicroseconds(10);         // aguarda por 10 microseconds

    microsecs -= 26; // como cada ciclo acima leva 26 microsegundos para ser executado, o while é executado até a condição não ser mais atendida
  }
  sei();  // this turns them back on
}